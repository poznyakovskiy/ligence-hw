# Software Requirements Specification (SRS)

## 1. Introduction

This document outlines the Software Requirements Specification (SRS) for a microservice-based system developed as part of a technical homework assignment. The system is designed to generate, modify, and verify images, with persistent storage and job tracking, using a Python backend, Redis queue, PostgreSQL database, and a simple frontend for interaction.

## 2. Overall Description

### 2.1 System Context

The system consists of:

- A FastAPI backend (`main.py`) exposing HTTP endpoints.
- Two background worker services (`generator.py`, `verifier.py`) for image generation and verification.
- A PostgreSQL database for persisting job and verification status.
- Redis queue for asynchronous job scheduling.
- A web-based frontend for user interaction.

### 2.2 Objectives

- Enable users to upload original images.
- Generate modified variants of the image using reversible transformation.
- Store both original and modified images.
- Verify modified images to identify originals.
- Display progress and results through a frontend UI.

## 3. Functional Requirements

### 3.1 Image Upload

- **Endpoint**: `POST /image`
- **Inputs**: Image file (PNG, JPG, JPEG).
- **Output**: `job_id` identifying the queued generation task.

### 3.2 Image Generation

- **Functionality**: Generates 100 variants of the uploaded image using a reversible transformation.
- **Stores**: Original and modified images.
- **Database**: An entry for the uploaded image and one entry per modified image.

### 3.3 Image Verification

- **Endpoint**: `POST /verify`
- **Functionality**: Applies the reverse transformation and checks whether the result matches any known original image.
- **Output**: Number of successful and failed verifications.

### 3.4 Job Status

- **Endpoint**: `GET /status/{job_id}`
- **Returns**: Progress percentage and status of the requested job.

### 3.5 Verification History

- **Endpoint**: `GET /verifications`
- **Returns**: List of past verification attempts with their status.

## 4. Non-functional Requirements

- **Portability**: Must run both locally and inside Docker.
- **Scalability**: Supports concurrent processing using Redis queue.
- **Robustness**: Handles failures gracefully, logs meaningful errors.
- **Maintainability**: Clear modular separation of functionality.

## 5. System Architecture

- **Frontend**: Static HTML/JS served by Nginx, communicates via REST.
- **Backend**: FastAPI-based app, scheduled jobs using RQ (Redis Queue).
- **Workers**: Independent containers running image generation and verification logic.
- **Storage**: Filesystem-based storage for images (mounted via Docker volume). Images are stored in the uncompressed TIFF format.
- **Database**: PostgreSQL.

## 6. Modification Algorithm

Each modified image is generated by performing a series of **XOR-based pixel swaps**:

- For each variant, the algorithm performs **between 100 and _n_** pixel modifications, where _n_ is the total number of pixels in the image.
- Each modification consists of **swapping the RGB values of two randomly chosen pixels** using a reversible XOR swap technique.
- The list of swap operations (i.e. pixel coordinate pairs) is saved as the **modification parameter**.
- To reverse the transformation, the exact same sequence of swaps is applied again in **reverse order**, using the same deterministic list of pixel pairs.

### Properties:
- **Fully reversible**: applying the same operation undoes the transformation.
- **Pixel-preserving**: the modification only changes the spatial arrangement, not the pixel values themselves.
- **Lightweight**: requires no external dependencies beyond NumPy or standard Python image manipulation tools.

This approach ensures that each image variant is uniquely traceable to its original and can be precisely verified for integrity.

## 7. Limitations

- Image comparison is based on exact match (no perceptual hash).

## 8. Assumptions

- Job IDs are sufficient to track processing state.
- Filesystem is persistent and shared between generator/verifier/backend.

## 9. Future Work

- Add user authentication and access control.
- Move filesystem and database from the local machine to the cloud.
